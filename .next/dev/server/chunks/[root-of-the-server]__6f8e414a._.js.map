{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/ryanrehan/Programming/Development/artisan-eats/src/lib/mongodb.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst { MONGODB_URI } = process.env;\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define MONGODB_URI in .env.local\");\n}\n\nlet cached = global.mongoose;\nif (!cached) {\n  cached = global.mongoose = { conn: null, promise: null };\n}\n\nexport async function connectDB() {\n  if (cached.conn) return cached.conn;\n\n  if (!cached.promise) {\n    cached.promise = mongoose\n      .connect(MONGODB_URI, { bufferCommands: false })\n      .then((mongooseInstance) => mongooseInstance);\n  }\n\n  cached.conn = await cached.promise;\n  return cached.conn;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,EAAE,WAAW,EAAE,GAAG,QAAQ,GAAG;AAEnC,IAAI,CAAC,aAAa;IAChB,MAAM,IAAI,MAAM;AAClB;AAEA,IAAI,SAAS,yDAAO,QAAQ;AAC5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEO,eAAe;IACpB,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IAEnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,OAAO,OAAO,GAAG,oNAAQ,CACtB,OAAO,CAAC,aAAa;YAAE,gBAAgB;QAAM,GAC7C,IAAI,CAAC,CAAC,mBAAqB;IAChC;IAEA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB"}},
    {"offset": {"line": 77, "column": 0}, "map": {"version":3,"sources":["file:///home/ryanrehan/Programming/Development/artisan-eats/src/models/Product.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst ProductSchema = new mongoose.Schema(\n  {\n    name: { type: String, required: true, trim: true },\n    slug: {\n      type: String,\n      required: true,\n      unique: true,\n      trim: true,\n      index: true,\n    },\n    category: {\n      type: mongoose.Schema.Types.ObjectId,\n      ref: \"Category\",\n      required: true,\n    },\n    categorySlug: { type: String, required: true, trim: true, index: true },\n    price: { type: Number, required: true },\n    oldPrice: { type: Number },\n    description: { type: String, default: \"\" },\n    details: [{ type: String }],\n    images: [{ type: String }],\n    inStock: { type: Boolean, default: true },\n    isBestSeller: { type: Boolean, default: false, index: true },\n    isOffer: { type: Boolean, default: false, index: true },\n  },\n  { timestamps: true },\n);\n\nProductSchema.index({ price: 1 });\n\nexport default mongoose.models.Product ||\n  mongoose.model(\"Product\", ProductSchema, \"products\");\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,gBAAgB,IAAI,oNAAQ,CAAC,MAAM,CACvC;IACE,MAAM;QAAE,MAAM;QAAQ,UAAU;QAAM,MAAM;IAAK;IACjD,MAAM;QACJ,MAAM;QACN,UAAU;QACV,QAAQ;QACR,MAAM;QACN,OAAO;IACT;IACA,UAAU;QACR,MAAM,oNAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ;QACpC,KAAK;QACL,UAAU;IACZ;IACA,cAAc;QAAE,MAAM;QAAQ,UAAU;QAAM,MAAM;QAAM,OAAO;IAAK;IACtE,OAAO;QAAE,MAAM;QAAQ,UAAU;IAAK;IACtC,UAAU;QAAE,MAAM;IAAO;IACzB,aAAa;QAAE,MAAM;QAAQ,SAAS;IAAG;IACzC,SAAS;QAAC;YAAE,MAAM;QAAO;KAAE;IAC3B,QAAQ;QAAC;YAAE,MAAM;QAAO;KAAE;IAC1B,SAAS;QAAE,MAAM;QAAS,SAAS;IAAK;IACxC,cAAc;QAAE,MAAM;QAAS,SAAS;QAAO,OAAO;IAAK;IAC3D,SAAS;QAAE,MAAM;QAAS,SAAS;QAAO,OAAO;IAAK;AACxD,GACA;IAAE,YAAY;AAAK;AAGrB,cAAc,KAAK,CAAC;IAAE,OAAO;AAAE;uCAEhB,oNAAQ,CAAC,MAAM,CAAC,OAAO,IACpC,oNAAQ,CAAC,KAAK,CAAC,WAAW,eAAe"}},
    {"offset": {"line": 153, "column": 0}, "map": {"version":3,"sources":["file:///home/ryanrehan/Programming/Development/artisan-eats/src/app/api/products/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { connectDB } from \"@/lib/mongodb\";\nimport Product from \"@/models/Product\";\n\nconst parseBoolean = (value) => {\n  if (value === null || value === undefined) return null;\n  if (value === \"true\") return true;\n  if (value === \"false\") return false;\n  return null;\n};\n\n\nexport async function GET(req) {\n  try {\n    await connectDB();\n    const { searchParams } = new URL(req.url);\n\n    const filter = {};\n\n    const category = searchParams.get(\"category\");\n    if (category) {\n      if (category === \"offer\") {\n        filter.isOffer = true;\n      } else if (category === \"best-seller\") {\n        filter.isBestSeller = true;\n      } else {\n        filter.categorySlug = category;\n      }\n    }\n\n    const isOffer = parseBoolean(searchParams.get(\"isOffer\"));\n    if (isOffer !== null) filter.isOffer = isOffer;\n\n    const isBestSeller = parseBoolean(searchParams.get(\"isBestSeller\"));\n    if (isBestSeller !== null) filter.isBestSeller = isBestSeller;\n\n    const inStock = parseBoolean(searchParams.get(\"inStock\"));\n    if (inStock !== null) filter.inStock = inStock;\n\n    const minPriceParam = searchParams.get(\"minPrice\");\n    const maxPriceParam = searchParams.get(\"maxPrice\");\n    const minPrice = minPriceParam !== null ? Number(minPriceParam) : null;\n    const maxPrice = maxPriceParam !== null ? Number(maxPriceParam) : null;\n\n    if (minPriceParam !== null || maxPriceParam !== null) {\n      const priceFilter = {};\n      if (minPriceParam !== null && !Number.isNaN(minPrice)) priceFilter.$gte = minPrice;\n      if (maxPriceParam !== null && !Number.isNaN(maxPrice)) priceFilter.$lte = maxPrice;\n      if (Object.keys(priceFilter).length > 0) {\n        filter.price = priceFilter;\n      }\n    }\n\n    const search = searchParams.get(\"search\");\n    if (search) {\n      const regex = new RegExp(search, \"i\");\n      filter.$or = [{ name: regex }, { description: regex }];\n    }\n\n    const sortParam = searchParams.get(\"sort\") || \"newest\";\n    let sort = { createdAt: -1 };\n    if (sortParam === \"price_asc\") sort = { price: 1 };\n    if (sortParam === \"price_desc\") sort = { price: -1 };\n    if (sortParam === \"name_asc\") sort = { name: 1 };\n    if (sortParam === \"name_desc\") sort = { name: -1 };\n\n    const page = Math.max(1, Number(searchParams.get(\"page\") || 1));\n    const limit = Math.max(1, Number(searchParams.get(\"limit\") || 12));\n    const skip = (page - 1) * limit;\n\n    const total = await Product.countDocuments(filter);\n\n    let products = [];\n    try {\n      products = await Product.find(filter)\n        .sort(sort)\n        .skip(skip)\n        .limit(limit)\n        .lean();\n    } catch (queryError) {\n      console.error(\"Product.find failed, falling back to raw collection:\", queryError);\n      products = await Product.collection\n        .find(filter)\n        .sort(sort)\n        .skip(skip)\n        .limit(limit)\n        .toArray();\n    }\n\n    const normalized = products.map((product) => ({\n      id: product._id.toString(),\n      name: product.name,\n      slug: product.slug,\n      category: product.category?.toString(),\n      categorySlug: product.categorySlug,\n      price: product.price,\n      oldPrice: product.oldPrice,\n      description: product.description || \"\",\n      details: product.details || [],\n      images: product.images || [],\n      inStock: Boolean(product.inStock),\n      isBestSeller: Boolean(product.isBestSeller),\n      isOffer: Boolean(product.isOffer),\n      createdAt: product.createdAt,\n      updatedAt: product.updatedAt,\n    }));\n\n    const totalPages = Math.max(1, Math.ceil(total / limit));\n\n    return NextResponse.json({\n      products: normalized,\n      total,\n      page,\n      totalPages,\n    });\n  } catch (error) {\n    console.error(\"GET /api/products failed:\", error);\n    return NextResponse.json(\n      { error: error?.message || \"Failed to load products\" },\n      { status: 500 },\n    );\n  }\n}\n"],"names":[],"mappings":"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"}}]
}